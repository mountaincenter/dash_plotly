# Grok ãƒ‡ã‚¤ãƒˆãƒ¬éŠ˜æŸ„é¸å®šãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ”¹å–„ - è¦ä»¶å®šç¾©æ›¸

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 1.0
**ä½œæˆæ—¥:** 2025-11-03
**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ:** Grok x_searchç‰ˆã¸ã®ç§»è¡Œã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®‰å…¨æ€§å¼·åŒ–

---

## ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [èƒŒæ™¯ã¨ç›®çš„](#2-èƒŒæ™¯ã¨ç›®çš„)
3. [ç¾çŠ¶ã®å•é¡Œç‚¹](#3-ç¾çŠ¶ã®å•é¡Œç‚¹)
4. [è§£æ±ºç­–ã®æ¦‚è¦](#4-è§£æ±ºç­–ã®æ¦‚è¦)
5. [ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#5-ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
6. [æ©Ÿèƒ½è¦ä»¶](#6-æ©Ÿèƒ½è¦ä»¶)
7. [éæ©Ÿèƒ½è¦ä»¶](#7-éæ©Ÿèƒ½è¦ä»¶)
8. [å®Ÿè£…ä»•æ§˜](#8-å®Ÿè£…ä»•æ§˜)
9. [ãƒ†ã‚¹ãƒˆè¦ä»¶](#9-ãƒ†ã‚¹ãƒˆè¦ä»¶)
10. [ãƒ‡ãƒªãƒãƒªãƒ¼è¨ˆç”»](#10-ãƒ‡ãƒªãƒãƒªãƒ¼è¨ˆç”»)
11. [ãƒªã‚¹ã‚¯ã¨åˆ¶ç´„äº‹é …](#11-ãƒªã‚¹ã‚¯ã¨åˆ¶ç´„äº‹é …)

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
**Grok ãƒ‡ã‚¤ãƒˆãƒ¬éŠ˜æŸ„é¸å®šãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ”¹å–„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**

### 1.2 ç›®çš„
1. **Grok x_searchç‰ˆã¸ã®ç§»è¡Œ**: XæŠ•ç¨¿ã®å®Ÿãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã«ã‚ˆã‚ŠéŠ˜æŸ„é¸å®šç²¾åº¦ã‚’å‘ä¸Š
2. **ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ãƒªã‚¹ã‚¯ã®æ’é™¤**: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªã«ã‚ˆã‚‹å®‰å…¨æ€§å¼·åŒ–
3. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ä¿è¨¼**: ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯ã«ã‚ˆã‚‹æ¤œè¨¼ä¸å¯èƒ½ãƒ‡ãƒ¼ã‚¿ã®æ’é™¤
4. **é‹ç”¨åŠ¹ç‡ã®å‘ä¸Š**: ä¸è¦ãªé‡è¤‡å‡¦ç†ã®å‰Šé™¤

### 1.3 å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ 
- **ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**: `.github/workflows/data-pipeline.yml`
- **Groké¸å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: `scripts/pipeline/generate_grok_trending.py`
- **æ–°è¦ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªã€ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

### 1.4 ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼
- **é–‹ç™ºè€…**: ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä¿å®ˆãƒ»é‹ç”¨
- **ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§GrokéŠ˜æŸ„ã‚’é–²è¦§
- **ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒŠãƒªã‚¹ãƒˆ**: ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœã®åˆ†æ

---

## 2. èƒŒæ™¯ã¨ç›®çš„

### 2.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èƒŒæ™¯

#### ç¾è¡Œã‚·ã‚¹ãƒ†ãƒ ï¼ˆv1_0_baselineï¼‰
- Grok APIã®`web_search()`ã®ã¿ä½¿ç”¨
- ä¸€èˆ¬çš„ãªWebæ¤œç´¢çµæœã‹ã‚‰éŠ˜æŸ„ã‚’é¸å®š
- **å•é¡Œ**: Webè¨˜äº‹ã®æƒ…å ±ã¯ä¸€èˆ¬çš„ã§ã€Xï¼ˆTwitterï¼‰ã®ç”Ÿã®å¸‚å ´ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆã‚’åæ˜ ã—ã¦ã„ãªã„

#### x_searchç‰ˆã®é–‹ç™ºçµŒç·¯
- xAIå…¬å¼ãŒ`x_search()`ãƒ„ãƒ¼ãƒ«ã‚’æä¾›ï¼ˆ$25/1,000 sourcesï¼‰
- å®Ÿéš›ã®XæŠ•ç¨¿ã‚’æ¤œç´¢ãƒ»æ¤œè¨¼å¯èƒ½
- **3æ—¥é–“ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœ**:
  - Phase2å‹ç‡: 41.5% â†’ **63.6%** (+22.1pt)
  - Phase2å¹³å‡ãƒªã‚¿ãƒ¼ãƒ³: +2.97%
  - è²»ç”¨: ç´„Â¥120-150/å›

### 2.2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç›®çš„

#### ä¸»è¦ç›®çš„
1. **éŠ˜æŸ„é¸å®šç²¾åº¦ã®å‘ä¸Š**: x_searchç‰ˆã®æœ¬ç•ªå°å…¥
2. **ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ãƒªã‚¹ã‚¯ã®æ’é™¤**: å†ç¾ä¸å¯èƒ½ãªGroké¸å®šçµæœã®å®Œå…¨ä¿è­·
3. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ä¿è¨¼**: æ¤œè¨¼ä¸å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆé˜²æ­¢
4. **é‹ç”¨åŠ¹ç‡ã®å‘ä¸Š**: ç„¡é§„ãªå‡¦ç†ã®å‰Šé™¤

#### æˆåŠŸåŸºæº–
- âœ… x_searchç‰ˆãŒæœ¬ç•ªç¨¼åƒ
- âœ… ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±äº‹æ•…ã‚¼ãƒ­
- âœ… ç¿Œæ—¥ä¼‘æ¥­æ—¥ã®ä¸è¦å®Ÿè¡Œã‚¼ãƒ­
- âœ… ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆé‡è¤‡å®Ÿè¡Œã®æ’é™¤

---

## 3. ç¾çŠ¶ã®å•é¡Œç‚¹

### 3.1 é‡å¤§ãªå•é¡Œï¼ˆä¿®æ­£å¿…é ˆï¼‰

| # | å•é¡Œ | æ·±åˆ»åº¦ | å½±éŸ¿ |
|---|------|-------|------|
| 1 | **23æ™‚ã®ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯ãŒæœªå®Ÿè£…** | ğŸ”´ æœ€é«˜ | æ¤œè¨¼ä¸å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã€ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ |
| 2 | **23æ™‚ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªãŒæœªå®Ÿè£…** | ğŸ”´ æœ€é«˜ | ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ãƒªã‚¹ã‚¯ï¼ˆå†ç¾ä¸å¯èƒ½ï¼‰ |
| 3 | **23æ™‚ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãŒæœªå®Ÿè£…** | ğŸ”´ æœ€é«˜ | æ—§æ–°éŠ˜æŸ„ã®æ··åœ¨ã€ãƒ‡ãƒ¼ã‚¿ç´”åº¦ä½ä¸‹ |
| 4 | **16æ™‚ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆé‡è¤‡å®Ÿè¡Œ** | ğŸŸ¡ ä¸­ | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä½ä¸‹ã€ãƒ­ã‚°å†—é•· |
| 5 | **23æ™‚ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆä¸è¦å®Ÿè¡Œ** | ğŸŸ  é«˜ | æ¸¬å®šç²¾åº¦ä½ä¸‹ã€ãƒã‚¤ã‚ºæ··å…¥ |

### 3.2 å•é¡Œã®è©³ç´°

#### å•é¡Œ1: ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯æœªå®Ÿè£…

**ç¾çŠ¶:**
```yaml
# 23æ™‚ã¯å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯ã‚’ã‚¹ã‚­ãƒƒãƒ—
elif [ "$CURRENT_HOUR" = "23" ]; then
  echo "skip_trading_check=true" >> $GITHUB_OUTPUT
```

**å•é¡Œã‚·ãƒŠãƒªã‚ª:**
```
é‡‘æ›œ23æ™‚å®Ÿè¡Œ â†’ ç¿Œæ—¥åœŸæ›œã¯ä¼‘æ¥­æ—¥
  â†“
Groké¸å®šå®Ÿè¡Œ â†’ åœŸæ›œæ—¥ã®éŠ˜æŸ„ã‚’é¸å®š
  â†“
ã—ã‹ã—åœŸæ›œã¯å–å¼•ã•ã‚Œãªã„
  â†“
backtestçµæœãŒå…¨ã¦NaN
  â†“
ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ âŒ
```

**å½±éŸ¿:**
- ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³æŠ½å‡ºã«æ‚ªå½±éŸ¿
- æˆåŠŸç‡ãƒ»å¤±æ•—ç‡ã®è¨ˆç®—ãŒæ­ªã‚€
- å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ãˆãªã„

#### å•é¡Œ2: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªæœªå®Ÿè£…

**ç¾çŠ¶:**
```python
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªãªã—ã§ä¸Šæ›¸ã
df.to_parquet("grok_trending.parquet", index=False)
```

**å•é¡Œã‚·ãƒŠãƒªã‚ª:**
```
16æ™‚ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¤±æ•—ï¼ˆæ°—ã¥ã‹ãšï¼‰
  â†“
23æ™‚ã«Groké¸å®šå®Ÿè¡Œ
  â†“
grok_trending.parquet ä¸Šæ›¸ã
  â†“
å‰æ—¥ã®é¸å®šçµæœãŒæ°¸ä¹…æ¶ˆå¤± âŒ
```

**å½±éŸ¿:**
- Groké¸å®šçµæœã¯**æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿**ã§ã‚ã‚Šå†ç¾ä¸å¯èƒ½
- XæŠ•ç¨¿ã¯æ™‚é–“ã¨ã¨ã‚‚ã«å¤‰åŒ–
- éå»ã®æ™‚ç‚¹ã®XçŠ¶æ…‹ã¯å¾©å…ƒä¸å¯èƒ½
- **ãƒ‡ãƒ¼ã‚¿æ°¸ä¹…æ¶ˆå¤±**

#### å•é¡Œ3: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æœªå®Ÿè£…

**ç¾çŠ¶:**
```python
# ä¸Šæ›¸ãå‡¦ç†ã ãŒã€å®Ÿè£…ã«ã‚ˆã£ã¦ã¯è¿½åŠ ã«ãªã‚‹å¯èƒ½æ€§
df.to_parquet("grok_trending.parquet", index=False)
```

**å•é¡Œã‚·ãƒŠãƒªã‚ª:**
```
10/30 23:00é¸å®š â†’ 10éŠ˜æŸ„ï¼ˆdate: 10/31ï¼‰
  â†“
10/31 23:00é¸å®š â†’ 10éŠ˜æŸ„ï¼ˆdate: 11/01ï¼‰è¿½åŠ 
  â†“
grok_trending.parquet ã«20éŠ˜æŸ„æ··åœ¨
  â†“
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§20éŠ˜æŸ„è¡¨ç¤º âŒ
```

**å½±éŸ¿:**
- ãƒ‡ãƒ¼ã‚¿ç´”åº¦ã®ä½ä¸‹
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®è¡¨ç¤ºä¸æ•´åˆ
- ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœã®æ­ªã¿

#### å•é¡Œ4: 16æ™‚ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆé‡è¤‡å®Ÿè¡Œ

**ç¾çŠ¶:**
```yaml
# ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å†…ã§å®Ÿè¡Œ
pipeline.save_backtest_to_archive

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ã‚‚å®Ÿè¡Œ
- name: Run backtest and archive
  if: success()  # â† 16æ™‚ã¨23æ™‚ã®ä¸¡æ–¹ã§å®Ÿè¡Œ
```

**å½±éŸ¿:**
- å®Ÿè¡Œæ™‚é–“ã®ç„¡é§„ï¼ˆç´„30ç§’ Ã— 2ï¼‰
- ãƒ­ã‚°ã®å†—é•·æ€§

#### å•é¡Œ5: 23æ™‚ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆä¸è¦å®Ÿè¡Œ

**ç¾çŠ¶:**
```yaml
- name: Run backtest and archive
  if: success()  # â† 23æ™‚ã«ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹
```

**å•é¡Œ:**
- 23æ™‚ã«é¸å®šã—ãŸéŠ˜æŸ„ã¯ã¾ã å–å¼•ã•ã‚Œã¦ã„ãªã„
- phase1_return, phase2_return ãªã©ãŒå…¨ã¦NaN
- æ„å‘³ã®ãªã„ãƒ‡ãƒ¼ã‚¿ãŒç”Ÿæˆã•ã‚Œã‚‹
- 16æ™‚ã®æ­£ã—ã„ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ãƒã‚¤ã‚ºã¨ãªã‚‹

---

## 4. è§£æ±ºç­–ã®æ¦‚è¦

### 4.1 è¨­è¨ˆæ€æƒ³

#### ã‚³ã‚¢åŸå‰‡: **ãƒ‡ãƒ¼ã‚¿ã®å†ç¾å¯èƒ½æ€§ã«ã‚ˆã‚‹å„ªå…ˆé †ä½ä»˜ã‘**

| ãƒ‡ãƒ¼ã‚¿ç¨®é¡ | å†ç¾å¯èƒ½æ€§ | å„ªå…ˆåº¦ | ç†ç”± |
|-----------|-----------|-------|------|
| **Groké¸å®šçµæœ** | âŒ **ä¸å¯èƒ½** | ğŸ”´ æœ€é«˜ | XæŠ•ç¨¿ã¯æ™‚ç³»åˆ—ã§å¤‰åŒ–ã€éå»çŠ¶æ…‹ã®å¾©å…ƒä¸å¯ |
| æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ | âœ… å¯èƒ½ | ğŸŸ¡ ä¸­ | yfinance, J-Quantsã‹ã‚‰å†å–å¾—å¯èƒ½ |
| ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆçµæœ | âœ… å¯èƒ½ | ğŸŸ¢ ä½ | Groké¸å®š + æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã§å†è¨ˆç®—å¯èƒ½ |
| ãƒ†ã‚¯ãƒ‹ã‚«ãƒ«æŒ‡æ¨™ | âœ… å¯èƒ½ | ğŸŸ¢ ä½ | æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å†è¨ˆç®—å¯èƒ½ |

#### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®éšœå®³è€æ€§

**æ ¸å¿ƒã¨ãªã‚‹æ€æƒ³:**
> ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã•ãˆã‚ã‚Œã°ã€ä»–ã®ãƒ‡ãƒ¼ã‚¿ã¯å¾Œã‹ã‚‰å†è¨ˆç®—ãƒ»é¡åŠã§ãã‚‹

**éšœå®³å¾©æ—§ã‚·ãƒŠãƒªã‚ª:**
```
J-Quantséšœå®³ â†’ æ ªä¾¡ãƒ‡ãƒ¼ã‚¿å–å¾—å¤±æ•—
  â†“
backtest/grok_trending_YYYYMMDD.parquet ãŒå­˜åœ¨
  â†“
ç¿Œæ—¥ã«æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’å†å–å¾—
  â†“
ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆã‚’å†å®Ÿè¡Œ
  â†“
å®Œå…¨å¾©æ—§ âœ…
```

### 4.2 è§£æ±ºç­–ã®å…¨ä½“åƒ

```
Phase 1: ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±é˜²æ­¢ï¼ˆæœ€å„ªå…ˆï¼‰
  1. S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
  2. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«çµ„ã¿è¾¼ã¿

Phase 2: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ä¿è¨¼ï¼ˆé«˜å„ªå…ˆï¼‰
  3. ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
  4. ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
  5. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«çµ„ã¿è¾¼ã¿

Phase 3: åŠ¹ç‡æ€§æ”¹å–„ï¼ˆä¸­å„ªå…ˆï¼‰
  6. generate_grok_trending.py ã‚’ x_searchç‰ˆã«æ›´æ–°
  7. ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¡ä»¶ä¿®æ­£ï¼ˆé‡è¤‡å»ƒæ­¢ï¼‰

Phase 4: æœ¬ç•ªå±•é–‹ï¼ˆæœ€çµ‚ï¼‰
  8. çµ±åˆãƒ†ã‚¹ãƒˆ
  9. æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤
  10. ç›£è¦–ãƒ»æ¤œè¨¼
```

---

## 5. ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 5.1 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼ˆ16æ™‚å®Ÿè¡Œï¼‰

```
16:00 cronèµ·å‹•
  â†“
[å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯] check_trading_day.py
  â†“ å–¶æ¥­æ—¥ã®ã¿
[ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ]
  1. meta_jquantsæ›´æ–°ï¼ˆé‡‘æ›œã®ã¿ï¼‰
  2. all_stocks.parquetçµ±åˆ
  3. æ ªä¾¡ãƒ‡ãƒ¼ã‚¿å–å¾—
  4. ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ â†’ backtest/grok_trending_archive.parquet ã«è¿½åŠ 
  5. ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ¡ã‚¿ç”Ÿæˆ
  6. å¸‚å ´ã‚µãƒãƒªãƒ¼ç”Ÿæˆ
  7. Manifestç”Ÿæˆãƒ»S3ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
  â†“
[ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: GROK trending ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—]
  backtest/grok_trending_YYYYMMDD.parquet ã‚’ä½œæˆ
  S3ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
```

### 5.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ï¼ˆ23æ™‚å®Ÿè¡Œï¼‰- ä¿®æ­£å¾Œ

```
23:00 cronèµ·å‹•
  â†“
[ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯] check_next_day_trading.py (NEW)
  â†“ ç¿Œæ—¥ãŒå–¶æ¥­æ—¥ã®ã¿
[S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª] verify_grok_backup.py (NEW)
  1. backtest/grok_trending_YYYYMMDD.parquet å­˜åœ¨ç¢ºèª
  2. backtest/grok_trending_archive.parquet ã«è©²å½“æ—¥ãƒ‡ãƒ¼ã‚¿å­˜åœ¨ç¢ºèª
  â†“ ä¸¡æ–¹OKã®ã¿
[ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—] cleanup_grok_trending.py (NEW)
  grok_trending.parquet ã‚’ç©ºã«ã™ã‚‹ï¼ˆã‚«ãƒ©ãƒ ã®ã¿æ®‹ã™ï¼‰
  â†“
[ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ]
  1. meta_jquantsæ›´æ–°ï¼ˆé‡‘æ›œã®ã¿ï¼‰
  2. Groké¸å®šå®Ÿè¡Œï¼ˆx_searchç‰ˆï¼‰ â† generate_grok_trending.py
  3. all_stocks.parquetçµ±åˆ
  4. æ ªä¾¡ãƒ‡ãƒ¼ã‚¿å–å¾—
  5. ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆãƒ¡ã‚¿ç”Ÿæˆï¼ˆç©ºï¼‰
  6. Manifestç”Ÿæˆãƒ»S3ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
```

### 5.3 S3ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### é‡è¦åŸå‰‡: **S3ãŒSingle Source of Truth**

```
GitHub Actions (æœ¬ç•ªç’°å¢ƒ)
  â†“
  å¿…ãšS3ã‹ã‚‰å–å¾—ãƒ»ç¢ºèª
  â†“
manifest.json ã§æœ€æ–°æ€§ã‚’ä¿è¨¼
  â†“
S3ã®ã¿ãŒä¿¡é ¼ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹

ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼ˆé–‹ç™ºç”¨ï¼‰
  â†“
scripts/sync/download_from_s3.py ã§åŒæœŸ
  â†“
â€»æœ¬ç•ªã§ã¯ä½¿ç”¨ã—ãªã„
```

#### S3ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
s3://stock-api-data/parquet/
  â”œâ”€â”€ manifest.json                          # æœ€æ–°æ€§ä¿è¨¼
  â”œâ”€â”€ grok_trending.parquet                 # æœ€æ–°ã®é¸å®šçµæœï¼ˆ1æ—¥åˆ†ã®ã¿ï¼‰
  â”œâ”€â”€ backtest/
  â”‚   â”œâ”€â”€ grok_trending_20251028.parquet   # æ—¥åˆ¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼ˆ7æ—¥ä¿æŒï¼‰
  â”‚   â”œâ”€â”€ grok_trending_20251029.parquet
  â”‚   â”œâ”€â”€ grok_trending_20251030.parquet
  â”‚   â”œâ”€â”€ grok_trending_20251031.parquet
  â”‚   â”œâ”€â”€ grok_trending_20251101.parquet
  â”‚   â”œâ”€â”€ grok_trending_20251102.parquet
  â”‚   â”œâ”€â”€ grok_trending_20251103.parquet
  â”‚   â””â”€â”€ grok_trending_archive.parquet     # å…¨å±¥æ­´ï¼ˆè¿½åŠ ã®ã¿ã€ä¸Šæ›¸ãå³ç¦ï¼‰
  â”œâ”€â”€ prices_max_1d.parquet
  â”œâ”€â”€ index_prices_max_1d.parquet
  â””â”€â”€ ...
```

#### S3ã®ä¿¡é ¼æ€§

| é …ç›® | ä»•æ§˜ | è©•ä¾¡ |
|------|------|------|
| Durability | 99.999999999% (11 nines) | æ¥µã‚ã¦é«˜ã„ |
| Availability | 99.99% | é«˜ã„ |
| éšœå®³äº‹ä¾‹ | AWSå…¨ä½“ãƒ¬ãƒ™ãƒ«ã®å¤§è¦æ¨¡éšœå®³æ™‚ã®ã¿ | æ¥µã‚ã¦ç¨€ |

**çµè«–:** S3ã‚’ä¿¡é ¼ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã—ã¦æ‰±ã†ãƒªã‚¹ã‚¯ã¯æ¥µã‚ã¦å°ã•ã„

---

## 6. æ©Ÿèƒ½è¦ä»¶

### 6.1 ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½

#### FR-001: ç¿Œæ—¥å–¶æ¥­æ—¥åˆ¤å®š

**ç›®çš„:**
ç¿Œæ—¥ãŒå–¶æ¥­æ—¥ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã€ä¼‘æ¥­æ—¥ã®å ´åˆã¯Groké¸å®šã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹

**å…¥åŠ›:**
- å®Ÿè¡Œæ—¥æ™‚ï¼ˆJSTï¼‰
- J-Quants `/markets/trading_calendar` API

**å‡¦ç†:**
1. ç¾åœ¨æ—¥æ™‚ï¼ˆJSTï¼‰ã‚’å–å¾—
2. æ˜æ—¥ã®æ—¥ä»˜ï¼ˆæš¦æ—¥ãƒ™ãƒ¼ã‚¹ï¼‰ã‚’è¨ˆç®—
3. J-Quants APIã‹ã‚‰æ˜æ—¥ã®æ—¥ä»˜ã®HolidayDivisionã‚’å–å¾—
4. HolidayDivisionã«åŸºã¥ãåˆ¤å®š

**å‡ºåŠ›:**
- Exit code 0: ç¿Œæ—¥ã¯å–¶æ¥­æ—¥ï¼ˆå®Ÿè¡Œã™ã¹ãï¼‰
- Exit code 1: ç¿Œæ—¥ã¯ä¼‘æ¥­æ—¥ï¼ˆã‚¹ã‚­ãƒƒãƒ—ã™ã¹ãï¼‰

**åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯:**

| HolidayDivision | æ„å‘³ | åˆ¤å®š |
|----------------|------|------|
| "1" | å–¶æ¥­æ—¥ | exit 0ï¼ˆå®Ÿè¡Œï¼‰ |
| "0" | ä¼‘æ¥­æ—¥ï¼ˆåœŸæ—¥ç¥ï¼‰ | exit 1ï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰ |
| "2" | ç‰¹åˆ¥ä¼‘æ¥­æ—¥ï¼ˆå¹´æœ«å¹´å§‹12æœˆ30æ—¥ãªã©ï¼‰ | exit 1ï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰ |

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:** `scripts/check_next_day_trading.py`

---

### 6.2 S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªæ©Ÿèƒ½

#### FR-002: S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å­˜åœ¨ç¢ºèª

**ç›®çš„:**
23æ™‚ã®Groké¸å®šå®Ÿè¡Œå‰ã«ã€16æ™‚ã«ä½œæˆã•ã‚ŒãŸãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãŒS3ã«æ­£ã—ãä¿å­˜ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

**å…¥åŠ›:**
- S3ãƒã‚±ãƒƒãƒˆåï¼ˆç’°å¢ƒå¤‰æ•° `S3_BUCKET`ï¼‰
- å¯¾è±¡æ—¥ï¼ˆYYYYMMDDå½¢å¼ï¼‰
- grok_trending.parquet ã® date ã‚«ãƒ©ãƒ 

**å‡¦ç†:**
1. grok_trending.parquet ã‹ã‚‰å¯¾è±¡æ—¥ã‚’å–å¾—
2. S3ä¸Šã® `backtest/grok_trending_YYYYMMDD.parquet` ã®å­˜åœ¨ã‚’ç¢ºèªï¼ˆhead_objectï¼‰
3. S3ä¸Šã® `backtest/grok_trending_archive.parquet` ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
4. archive.parquet ã«è©²å½“æ—¥ã®ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª

**å‡ºåŠ›:**
- Exit code 0: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ­£å¸¸ï¼ˆå®Ÿè¡Œå¯èƒ½ï¼‰
- Exit code 1: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸å®Œå…¨ï¼ˆå®Ÿè¡Œä¸­æ–­ï¼‰

**é‡è¦:** å¿…ãšS3ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã€‚ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªã¯å³ç¦ã€‚

**ç¢ºèªé …ç›®:**

| # | ç¢ºèªå¯¾è±¡ | ç¢ºèªæ–¹æ³• | å¤±æ•—æ™‚ã®å‹•ä½œ |
|---|---------|---------|-------------|
| 1 | YYYYMMDD.parquetå­˜åœ¨ | `s3_client.head_object()` | exit 1ï¼ˆä¸­æ–­ï¼‰ |
| 2 | archive.parquetå­˜åœ¨ | `s3_client.head_object()` | exit 1ï¼ˆä¸­æ–­ï¼‰ |
| 3 | archiveå†…ã®è©²å½“æ—¥ãƒ‡ãƒ¼ã‚¿ | pandas ã§èª­ã¿è¾¼ã¿ç¢ºèª | exit 1ï¼ˆä¸­æ–­ï¼‰ |

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:** `scripts/verify_grok_backup.py`

---

### 6.3 ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æ©Ÿèƒ½

#### FR-003: grok_trending.parquet ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

**ç›®çš„:**
æ—§éŠ˜æŸ„ã¨æ–°éŠ˜æŸ„ã®æ··åœ¨ã‚’é˜²ããŸã‚ã€Groké¸å®šå®Ÿè¡Œå‰ã«grok_trending.parquetã‚’ã‚¯ãƒªãƒ¼ãƒ³ã«ã™ã‚‹

**å‰ææ¡ä»¶:**
- FR-002ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªï¼‰ãŒæˆåŠŸã—ã¦ã„ã‚‹ã“ã¨

**å…¥åŠ›:**
- grok_trending.parquetï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

**å‡¦ç†:**
1. grok_trending.parquet ã‚’èª­ã¿è¾¼ã¿
2. ã‚«ãƒ©ãƒ æ§‹é€ ã‚’ä¿æŒã—ãŸã¾ã¾å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤
3. ç©ºã®DataFrameã¨ã—ã¦ä¿å­˜

**å‡ºåŠ›:**
- Exit code 0: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æˆåŠŸ
- Exit code 1: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¤±æ•—

**å®Ÿè£…ä¾‹:**
```python
df = pd.read_parquet("grok_trending.parquet")
df_empty = df.iloc[:0]  # ã‚«ãƒ©ãƒ æ§‹é€ ã ã‘ä¿æŒ
df_empty.to_parquet("grok_trending.parquet", index=False)
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:** `scripts/cleanup_grok_trending.py`

---

### 6.4 Grok x_searchç‰ˆé¸å®šæ©Ÿèƒ½

#### FR-004: x_search ã‚’ä½¿ç”¨ã—ãŸéŠ˜æŸ„é¸å®š

**ç›®çš„:**
XæŠ•ç¨¿ã®å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼ã—ã¦ãƒ‡ã‚¤ãƒˆãƒ¬éŠ˜æŸ„ã‚’é¸å®šï¼ˆç²¾åº¦å‘ä¸Šï¼‰

**å¤‰æ›´ç‚¹:**

| é …ç›® | v1_0_baseline | v1_1_web_search |
|------|--------------|----------------|
| Tools | `web_search()` ã®ã¿ | `web_search()` + **`x_search()`** |
| ã‚³ã‚¹ãƒˆ | åŸºæœ¬æ–™é‡‘ã®ã¿ | +$25/1,000 sources |
| ç²¾åº¦ | Phase2å‹ç‡ 41.5% | Phase2å‹ç‡ **63.6%** |
| ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ | v1_0_baseline | **v1_1_web_search** |

**å®Ÿè£…:**
```python
from xai_sdk import Client
from xai_sdk.tools import web_search, x_search

client = Client(api_key=api_key)
chat = client.chat.create(
    model="grok-4-fast-reasoning",
    messages=[...],
    tools=[web_search(), x_search()],  # â† x_search è¿½åŠ 
    temperature=0.7,
    max_tokens=4000,
)
```

**ç’°å¢ƒå¤‰æ•°:**
```bash
PROMPT_VERSION=v1_1_web_search python3 generate_grok_trending.py
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:** `scripts/pipeline/generate_grok_trending.py`

---

### 6.5 Slacké€šçŸ¥æ©Ÿèƒ½

#### FR-006: å…¨ãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œSlacké€šçŸ¥

**ç›®çš„:**
ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å®Ÿè¡ŒçŠ¶æ³ã‚’å…¨ã¦Slackã§é€šçŸ¥ã—ã€é‹ç”¨çŠ¶æ³ã®å¯è¦–åŒ–ã¨cronå‹•ä½œç¢ºèªã‚’å®Ÿç¾

**åŸºæœ¬åŸå‰‡:**
1. **å…¨ã¦ã®å®Ÿè¡Œã§å¿…ãšé€šçŸ¥**: æˆåŠŸã€å¤±æ•—ã€ã‚¹ã‚­ãƒƒãƒ—å…¨ã¦ã§é€ä¿¡
2. **ã‚¹ã‚­ãƒƒãƒ—ã‚‚ã€ŒæˆåŠŸã€æ‰±ã„**: exit 0ã§çµ‚äº†ã—ã€ã€Œæ›´æ–°ã—ãªã‹ã£ãŸã€ã“ã¨ã‚’é€šçŸ¥
3. **MECEï¼ˆæ¼ã‚Œãªãã€ãƒ€ãƒ–ã‚Šãªãï¼‰**: å…¨10ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¶²ç¾…

#### é€šçŸ¥ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆMECEç¢ºèªæ¸ˆã¿ï¼‰

##### 16æ™‚å®Ÿè¡Œï¼ˆå½“æ—¥ãŒå–¶æ¥­æ—¥ã‹ãƒã‚§ãƒƒã‚¯ï¼‰

| å½“æ—¥â†’ç¿Œæ—¥ | æ¡ä»¶ | å®Ÿè¡Œ | Slacké€šçŸ¥ |
|----------|------|-----|----------|
| **1â†’1** | æœˆç«æ°´æœ¨ | âœ… å®Ÿè¡Œ | âœ… æˆåŠŸ + å¸‚å ´ã‚µãƒãƒªãƒ¼ |
| **1â†’0** | é‡‘æ›œ | âœ… å®Ÿè¡Œ | âœ… æˆåŠŸ + **meta_jquantsæ›´æ–°(é€±æ¬¡)** + å¸‚å ´ã‚µãƒãƒªãƒ¼ |
| **0â†’0** | åœŸæ›œ | âŒ ã‚¹ã‚­ãƒƒãƒ— | âœ… æˆåŠŸï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰ + ã€Œæ›´æ–°ã—ãªã‹ã£ãŸã€ |
| **0â†’1** | æ—¥æ›œ | âŒ ã‚¹ã‚­ãƒƒãƒ— | âœ… æˆåŠŸï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰ + ã€Œæ›´æ–°ã—ãªã‹ã£ãŸã€ |
| ï¼ˆå¤±æ•—ï¼‰ | - | âŒ å¤±æ•— | âŒ å¤±æ•— + ã‚¨ãƒ©ãƒ¼è©³ç´° |

**å‡¡ä¾‹:**
- 1 = å–¶æ¥­æ—¥ï¼ˆHolidayDivision="1"ï¼‰
- 0 = ä¼‘æ¥­æ—¥ï¼ˆHolidayDivision="0" or "2"ï¼‰

##### 23æ™‚å®Ÿè¡Œï¼ˆç¿Œæ—¥ãŒå–¶æ¥­æ—¥ã‹ãƒã‚§ãƒƒã‚¯ï¼‰

| å½“æ—¥â†’ç¿Œæ—¥ | æ¡ä»¶ | å®Ÿè¡Œ | Slacké€šçŸ¥ |
|----------|------|-----|----------|
| **1â†’1** | æœˆç«æ°´æœ¨ | âœ… å®Ÿè¡Œ | âœ… æˆåŠŸ + Grokæ›´æ–°ãƒªã‚¹ãƒˆ |
| **1â†’0** | é‡‘æ›œ | âŒ ã‚¹ã‚­ãƒƒãƒ— | âœ… æˆåŠŸï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰ + ã€Œæ›´æ–°ã—ãªã‹ã£ãŸã€ |
| **0â†’0** | åœŸæ›œ | âŒ ã‚¹ã‚­ãƒƒãƒ— | âœ… æˆåŠŸï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰ + ã€Œæ›´æ–°ã—ãªã‹ã£ãŸã€ |
| **0â†’1** | æ—¥æ›œ | âœ… å®Ÿè¡Œ | âœ… æˆåŠŸ + Grokæ›´æ–°ãƒªã‚¹ãƒˆ |
| ï¼ˆå¤±æ•—ï¼‰ | - | âŒ å¤±æ•— | âŒ å¤±æ•— + ã‚¨ãƒ©ãƒ¼è©³ç´° |

#### é€šçŸ¥å†…å®¹ã®è©³ç´°

**16æ™‚ - æˆåŠŸï¼ˆ1â†’1ï¼‰: æœˆç«æ°´æœ¨**
```
âœ… Data Pipeline Succeeded (16:00 JST)

ğŸ“Š å›½å†…æ ªå¼å¸‚å ´ã‚µãƒãƒªãƒ¼
ãƒ»æ—¥çµŒå¹³å‡: +1.2% (38,500å††)
ãƒ»TOPIX: +0.8%
ãƒ»æ³¨ç›®: åŠå°ä½“é–¢é€£ãŒæ€¥ä¼¸

çµ±è¨ˆ:
- meta_jquants: 4,000éŠ˜æŸ„
- all_stocks: 4,050éŠ˜æŸ„
- latest_price: 2025-11-03

[View Workflow Run]
```

**16æ™‚ - æˆåŠŸï¼ˆ1â†’0ï¼‰: é‡‘æ›œ**
```
âœ… Data Pipeline Succeeded (16:00 JST)

ğŸ“Š å›½å†…æ ªå¼å¸‚å ´ã‚µãƒãƒªãƒ¼
ãƒ»æ—¥çµŒå¹³å‡: +1.2% (38,500å††)
ãƒ»TOPIX: +0.8%
ãƒ»æ³¨ç›®: åŠå°ä½“é–¢é€£ãŒæ€¥ä¼¸

âœ¨ é€±æ¬¡æ›´æ–°
- meta_jquants: 4,000éŠ˜æŸ„ï¼ˆé€±æ¬¡æ›´æ–°å®Œäº†ï¼‰

çµ±è¨ˆ:
- all_stocks: 4,050éŠ˜æŸ„
- latest_price: 2025-11-03

[View Workflow Run]
```

**16æ™‚ - ã‚¹ã‚­ãƒƒãƒ—ï¼ˆ0â†’0, 0â†’1ï¼‰: åœŸæ—¥**
```
â„¹ï¸ Data Pipeline Skipped (16:00 JST)

ä»Šæ—¥ã¯ä¼‘æ¥­æ—¥ã®ãŸã‚å®Ÿè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸ

æ¬¡å›å®Ÿè¡Œäºˆå®š: 2025-11-04 (æœˆ) 16:00
```

**16æ™‚ - å¤±æ•—**
```
âŒ Data Pipeline Failed (16:00 JST)

ã‚¨ãƒ©ãƒ¼: pipeline.fetch_prices ã§å¤±æ•—
åŸå› : yfinance API ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

âš ï¸ å¯¾å¿œãŒå¿…è¦ã§ã™

[View Workflow Run]
```

**23æ™‚ - æˆåŠŸï¼ˆ1â†’1, 0â†’1ï¼‰: æœˆç«æ°´æœ¨ã€æ—¥æ›œ**
```
âœ… Data Pipeline Succeeded (23:00 JST)

ğŸ¯ ç¿Œå–¶æ¥­æ—¥ã®Groké¸å®šéŠ˜æŸ„ (2025-11-04)

Top5:
1. â­ 7203 ãƒˆãƒ¨ã‚¿è‡ªå‹•è»Š (Score: 95.2)
   ç†ç”±: åŒ—ç±³è²©å£²å¥½èª¿ã€XæŠ•ç¨¿ã§è©±é¡Œ
2. â­ 6758 ã‚½ãƒ‹ãƒ¼G (Score: 92.1)
   ç†ç”±: AIåŠå°ä½“éœ€è¦æ‹¡å¤§
3. â­ 9984 ã‚½ãƒ•ãƒˆãƒãƒ³ã‚¯G (Score: 89.5)
4. â­ 4063 ä¿¡è¶ŠåŒ–å­¦ (Score: 87.3)
5. â­ 6861 ã‚­ãƒ¼ã‚¨ãƒ³ã‚¹ (Score: 85.1)

çµ±è¨ˆ:
- é¸å®šéŠ˜æŸ„: 10éŠ˜æŸ„
- ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: å®Œäº†
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—: å®Œäº†

[View Workflow Run]
```

**23æ™‚ - ã‚¹ã‚­ãƒƒãƒ—ï¼ˆ1â†’0, 0â†’0ï¼‰: é‡‘åœŸ**
```
â„¹ï¸ Data Pipeline Skipped (23:00 JST)

ç¿Œæ—¥ãŒä¼‘æ¥­æ—¥ã®ãŸã‚å®Ÿè¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸ

æ¬¡å›å®Ÿè¡Œäºˆå®š: 2025-11-03 (æ—¥) 23:00
```

**23æ™‚ - å¤±æ•—**
```
âŒ Data Pipeline Failed (23:00 JST)

ã‚¨ãƒ©ãƒ¼: pipeline.generate_grok_trending ã§å¤±æ•—
åŸå› : Grok API ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

âš ï¸ å¯¾å¿œãŒå¿…è¦ã§ã™

[View Workflow Run]
```

#### ç‰¹æ®Šã‚±ãƒ¼ã‚¹: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªå¤±æ•—ï¼ˆ23æ™‚ã®ã¿ï¼‰

```
âš ï¸ Data Pipeline Aborted (23:00 JST)

ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªã«å¤±æ•—ã—ã¾ã—ãŸ

åŸå› :
- backtest/grok_trending_20251103.parquet ãŒå­˜åœ¨ã—ãªã„
- 16æ™‚ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å‡¦ç†ãŒå¤±æ•—ã—ãŸå¯èƒ½æ€§

âš ï¸ ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±é˜²æ­¢ã®ãŸã‚å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã—ãŸ
âš ï¸ 16æ™‚ã®ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ãã ã•ã„

[View Workflow Run]
```

#### å®Ÿè£…è¦ä»¶

**å…¥åŠ›:**
- å®Ÿè¡Œæ™‚åˆ»ï¼ˆ16æ™‚ or 23æ™‚ï¼‰
- å½“æ—¥ã®å–¶æ¥­æ—¥ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
- ç¿Œæ—¥ã®å–¶æ¥­æ—¥ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆ23æ™‚ã®ã¿ï¼‰
- ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œçµæœ
- å„ã‚¹ãƒ†ãƒƒãƒ—ã®å®Ÿè¡Œçµæœ

**å‡¦ç†:**
1. å–¶æ¥­æ—¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ¤å®šï¼ˆ1â†’1, 1â†’0, 0â†’0, 0â†’1ï¼‰
2. ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµæœã‚’ç¢ºèªï¼ˆæˆåŠŸã€å¤±æ•—ã€ã‚¹ã‚­ãƒƒãƒ—ï¼‰
3. é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ
4. Slack Webhookã«é€ä¿¡

**å‡ºåŠ›:**
- Slacké€šçŸ¥ï¼ˆå¿…ãšé€ä¿¡ï¼‰
- Exit code 0ï¼ˆå¸¸ã«æˆåŠŸï¼‰

**å®Ÿè£…æ–¹æ³•:**
```yaml
- name: Send Slack notification
  if: always()  # æˆåŠŸãƒ»å¤±æ•—ãƒ»ã‚¹ã‚­ãƒƒãƒ—ã«é–¢ã‚ã‚‰ãšå¿…ãšå®Ÿè¡Œ
  env:
    SLACK_WEBHOOK_URL: ${{ secrets.SLACK_INCOMING_WEBHOOK_URL }}
  run: |
    # æ—¢å­˜ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ‹¡å¼µ
    # format_grok_slack.py, format_market_summary_slack.py ã‚’æ´»ç”¨
    # ã‚¹ã‚­ãƒƒãƒ—æ™‚ã®é€šçŸ¥ã‚’è¿½åŠ 
```

**é‡è¦ãªè¨­è¨ˆ:**
- ã‚¹ã‚­ãƒƒãƒ—æ™‚ã‚‚ exit 0 ã§çµ‚äº†ï¼ˆGitHub Actionsçš„ã«ã¯æˆåŠŸï¼‰
- `if: always()` ã§å¿…ãšå®Ÿè¡Œ
- 10ãƒ‘ã‚¿ãƒ¼ãƒ³å…¨ã¦ã«å¯¾å¿œ

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:**
- `.github/workflows/data-pipeline.yml` (é€šçŸ¥ã‚¹ãƒ†ãƒƒãƒ—)
- `scripts/format_grok_slack.py` (æ—¢å­˜)
- `scripts/format_market_summary_slack.py` (æ—¢å­˜)

---

### 6.6 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¡ä»¶ä¿®æ­£

#### FR-005: é‡è¤‡å®Ÿè¡Œã®æ’é™¤

**ç›®çš„:**
16æ™‚ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆé‡è¤‡å®Ÿè¡Œã¨23æ™‚ã®ä¸è¦ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’æ’é™¤

**ä¿®æ­£å†…å®¹:**

| ã‚¹ãƒ†ãƒƒãƒ— | ä¿®æ­£å‰ | ä¿®æ­£å¾Œ |
|---------|-------|-------|
| Run backtest and archive | `if: success()` | `if: success() && skip_grok == 'true'` |
| å®Ÿè¡Œã‚¿ã‚¤ãƒŸãƒ³ã‚° | 16æ™‚ã¨23æ™‚ | **16æ™‚ã®ã¿** |

**ç†ç”±:**
- ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å†…ã§æ—¢ã« `pipeline.save_backtest_to_archive` å®Ÿè¡Œæ¸ˆã¿
- 23æ™‚ã¯ã¾ã å–å¼•ã•ã‚Œã¦ã„ãªã„ãŸã‚ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆä¸å¯èƒ½

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«:** `.github/workflows/data-pipeline.yml`

---

## 7. éæ©Ÿèƒ½è¦ä»¶

### 7.1 ä¿¡é ¼æ€§è¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-001 | ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±ã‚¼ãƒ­ | Groké¸å®šçµæœã®æ¶ˆå¤±äº‹æ•…ã‚¼ãƒ­ | ğŸ”´ æœ€é«˜ |
| NFR-002 | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆåŠŸç‡ | 99.9%ä»¥ä¸Š | ğŸ”´ æœ€é«˜ |
| NFR-003 | ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ | æ¤œè¨¼ä¸å¯èƒ½ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆã‚¼ãƒ­ | ğŸ”´ æœ€é«˜ |
| NFR-004 | Fail-fast | ç•°å¸¸æ¤œçŸ¥æ™‚ã¯å³åº§ã«å‡¦ç†ä¸­æ–­ | ğŸŸ  é«˜ |

### 7.2 å¯ç”¨æ€§è¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-005 | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç¨¼åƒç‡ | 99%ä»¥ä¸Š | ğŸŸ  é«˜ |
| NFR-006 | éšœå®³å¾©æ—§æ™‚é–“ | 24æ™‚é–“ä»¥å†… | ğŸŸ¡ ä¸­ |
| NFR-007 | S3å¯ç”¨æ€§ | AWS SLAã«æº–æ‹ ï¼ˆ99.99%ï¼‰ | ğŸŸ¢ ä½ |

### 7.3 æ€§èƒ½è¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-008 | 16æ™‚ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œæ™‚é–“ | 15åˆ†ä»¥å†… | ğŸŸ¡ ä¸­ |
| NFR-009 | 23æ™‚ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œæ™‚é–“ | 10åˆ†ä»¥å†… | ğŸŸ¡ ä¸­ |
| NFR-010 | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªæ™‚é–“ | 30ç§’ä»¥å†… | ğŸŸ¢ ä½ |

### 7.4 ä¿å®ˆæ€§è¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-011 | ãƒ­ã‚°å‡ºåŠ› | å…¨å‡¦ç†ã®æˆåŠŸ/å¤±æ•—ã‚’è¨˜éŒ² | ğŸŸ  é«˜ |
| NFR-012 | ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | åŸå› ç‰¹å®šå¯èƒ½ãªè©³ç´°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | ğŸŸ  é«˜ |
| NFR-013 | ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ | å…¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«docstring | ğŸŸ¡ ä¸­ |

### 7.5 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-014 | API Keyç®¡ç† | GitHub Secretsã§ç®¡ç† | ğŸ”´ æœ€é«˜ |
| NFR-015 | S3ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ | IAMãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹ | ğŸ”´ æœ€é«˜ |
| NFR-016 | ãƒ‡ãƒ¼ã‚¿æš—å·åŒ– | S3ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–ï¼ˆat restï¼‰ | ğŸŸ¡ ä¸­ |

### 7.6 ã‚³ã‚¹ãƒˆè¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-017 | Grok API ã‚³ã‚¹ãƒˆ | æœˆé¡Â¥5,000ä»¥å†… | ğŸŸ¡ ä¸­ |
| NFR-018 | S3ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚³ã‚¹ãƒˆ | æœˆé¡Â¥500ä»¥å†… | ğŸŸ¢ ä½ |
| NFR-019 | GitHub Actionså®Ÿè¡Œæ™‚é–“ | æœˆé¡ç„¡æ–™æ å†… | ğŸŸ¢ ä½ |

### 7.7 é€šçŸ¥è¦ä»¶

| # | è¦ä»¶ | åŸºæº– | å„ªå…ˆåº¦ |
|---|------|------|-------|
| NFR-020 | Slacké€šçŸ¥é€ä¿¡ç‡ | 100%ï¼ˆå…¨ã¦ã®å®Ÿè¡Œã§é€ä¿¡ï¼‰ | ğŸ”´ æœ€é«˜ |
| NFR-021 | é€šçŸ¥å†…å®¹ã®æ­£ç¢ºæ€§ | ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ¤å®š100%æ­£ç¢º | ğŸ”´ æœ€é«˜ |
| NFR-022 | ã‚¹ã‚­ãƒƒãƒ—é€šçŸ¥ | ä¼‘æ¥­æ—¥ã‚¹ã‚­ãƒƒãƒ—æ™‚ã‚‚å¿…ãšé€ä¿¡ | ğŸŸ  é«˜ |
| NFR-023 | å¤±æ•—é€šçŸ¥ | ã‚¨ãƒ©ãƒ¼ç®‡æ‰€ã‚’æ˜ç¤º | ğŸŸ  é«˜ |
| NFR-024 | é€šçŸ¥é…å»¶ | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³çµ‚äº†å¾Œ1åˆ†ä»¥å†… | ğŸŸ¡ ä¸­ |

**é€šçŸ¥å†…å®¹ã®è¦ä»¶:**
- âœ… å…¨10ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆMECEï¼‰ã«å¯¾å¿œ
- âœ… ã‚¹ã‚­ãƒƒãƒ—ã‚‚ã€ŒæˆåŠŸã€ã¨ã—ã¦é€šçŸ¥ï¼ˆexit 0ï¼‰
- âœ… cronå‹•ä½œç¢ºèªãŒå¯èƒ½
- âœ… å–¶æ¥­æ—¥ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ1â†’1, 1â†’0, 0â†’0, 0â†’1ï¼‰ã‚’æ˜ç¤º

---

## 8. å®Ÿè£…ä»•æ§˜

### 8.1 scripts/check_next_day_trading.py

#### 8.1.1 æ¦‚è¦

ç¿Œæ—¥ï¼ˆæš¦æ—¥ï¼‰ãŒå–¶æ¥­æ—¥ã‹ã©ã†ã‹ã‚’J-Quants APIã§ç¢ºèªã—ã€å–¶æ¥­æ—¥ãªã‚‰ exit 0ã€ä¼‘æ¥­æ—¥ãªã‚‰ exit 1 ã‚’è¿”ã™ã€‚

#### 8.1.2 å…¥å‡ºåŠ›ä»•æ§˜

**å…¥åŠ›:**
- ãªã—ï¼ˆå®Ÿè¡Œæ™‚åˆ»ã‹ã‚‰è‡ªå‹•åˆ¤å®šï¼‰

**å‡ºåŠ›:**
- Exit code 0: ç¿Œæ—¥ã¯å–¶æ¥­æ—¥
- Exit code 1: ç¿Œæ—¥ã¯ä¼‘æ¥­æ—¥
- æ¨™æº–å‡ºåŠ›: åˆ¤å®šçµæœã®ãƒ­ã‚°

#### 8.1.3 å‡¦ç†ãƒ•ãƒ­ãƒ¼

```python
1. ç¾åœ¨æ—¥æ™‚ï¼ˆJSTï¼‰ã‚’å–å¾—
2. æ˜æ—¥ã®æ—¥ä»˜ã‚’è¨ˆç®—ï¼ˆdate.today() + timedelta(days=1)ï¼‰
3. J-Quants APIã‹ã‚‰å–¶æ¥­æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’å–å¾—
   - ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: /markets/trading_calendar
   - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: from=æ˜æ—¥, to=æ˜æ—¥
4. HolidayDivisionã‚’ç¢ºèª
   - "1" â†’ exit(0)
   - "0" or "2" â†’ exit(1)
5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
   - APIéšœå®³æ™‚: exit(1)ï¼ˆå®‰å…¨å´ã«å€’ã™ï¼‰
```

#### 8.1.4 å®Ÿè£…ä¾‹ï¼ˆéª¨æ ¼ï¼‰

```python
#!/usr/bin/env python3
"""
check_next_day_trading.py
ç¿Œæ—¥ï¼ˆæš¦æ—¥ï¼‰ãŒå–¶æ¥­æ—¥ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯

Exit codes:
  0: ç¿Œæ—¥ã¯å–¶æ¥­æ—¥ â†’ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œã™ã¹ã
  1: ç¿Œæ—¥ã¯ä¼‘æ¥­æ—¥ â†’ ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚¹ã‚­ãƒƒãƒ—ã™ã¹ã
"""
import sys
from pathlib import Path
from datetime import datetime, timedelta, timezone

ROOT = Path(__file__).resolve().parents[2]
sys.path.insert(0, str(ROOT))

from scripts.lib.jquants_fetcher import JQuantsFetcher

def main() -> int:
    # 1. æ˜æ—¥ã®æ—¥ä»˜ã‚’å–å¾—ï¼ˆJSTï¼‰
    jst = timezone(timedelta(hours=9))
    now_jst = datetime.now(jst)
    tomorrow = (now_jst + timedelta(days=1)).date()

    print(f"[INFO] Current time (JST): {now_jst.strftime('%Y-%m-%d %H:%M:%S')}")
    print(f"[INFO] Checking if tomorrow ({tomorrow}) is a trading day...")

    # 2. J-Quants APIã‹ã‚‰å–¶æ¥­æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’å–å¾—
    fetcher = JQuantsFetcher()
    params = {
        "from": str(tomorrow),
        "to": str(tomorrow)
    }

    try:
        response = fetcher.client.request("/markets/trading_calendar", params=params)
        calendar = response.get("trading_calendar", [])

        if not calendar:
            print(f"[WARN] No calendar data for {tomorrow}")
            print(f"[WARN] Assuming non-trading day (fail-safe)")
            return 1

        # 3. HolidayDivisionã‚’ç¢ºèª
        holiday_division = calendar[0].get("HolidayDivision")

        if holiday_division == "1":
            print(f"[OK] Tomorrow ({tomorrow}) is a TRADING day (HolidayDivision=1)")
            print(f"[OK] Pipeline should execute")
            return 0
        elif holiday_division == "0":
            print(f"[SKIP] Tomorrow ({tomorrow}) is a NON-TRADING day (HolidayDivision=0: weekend/holiday)")
            print(f"[SKIP] Pipeline will be skipped")
            return 1
        elif holiday_division == "2":
            print(f"[SKIP] Tomorrow ({tomorrow}) is a SPECIAL NON-TRADING day (HolidayDivision=2: year-end)")
            print(f"[SKIP] Pipeline will be skipped")
            return 1
        else:
            print(f"[WARN] Unknown HolidayDivision: {holiday_division}")
            print(f"[WARN] Assuming non-trading day (fail-safe)")
            return 1

    except Exception as e:
        print(f"[ERROR] Failed to check trading calendar: {e}")
        print(f"[ERROR] Assuming non-trading day (fail-safe)")
        return 1

if __name__ == "__main__":
    raise SystemExit(main())
```

---

### 8.2 scripts/verify_grok_backup.py

#### 8.2.1 æ¦‚è¦

S3ä¸Šã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ã‚’ç¢ºèªã—ã€ä¸¡æ–¹ãŒæ­£ã—ãä¿å­˜ã•ã‚Œã¦ã„ã‚Œã° exit 0ã€ä¸å®Œå…¨ãªã‚‰ exit 1 ã‚’è¿”ã™ã€‚

#### 8.2.2 å…¥å‡ºåŠ›ä»•æ§˜

**å…¥åŠ›:**
- `--bucket`: S3ãƒã‚±ãƒƒãƒˆåï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: ç’°å¢ƒå¤‰æ•° `S3_BUCKET`ï¼‰
- `--date`: å¯¾è±¡æ—¥ï¼ˆYYYYMMDDå½¢å¼ï¼‰

**å‡ºåŠ›:**
- Exit code 0: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ­£å¸¸
- Exit code 1: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸å®Œå…¨
- æ¨™æº–å‡ºåŠ›: ç¢ºèªçµæœã®ãƒ­ã‚°

#### 8.2.3 å‡¦ç†ãƒ•ãƒ­ãƒ¼

```python
1. S3ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–
2. grok_trending.parquet ã‹ã‚‰å¯¾è±¡æ—¥ã‚’å–å¾—
3. S3: backtest/grok_trending_YYYYMMDD.parquet ã®å­˜åœ¨ç¢ºèª
   - head_object() ã§ç¢ºèªï¼ˆãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸è¦ï¼‰
4. S3: backtest/grok_trending_archive.parquet ã®å­˜åœ¨ç¢ºèª
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è©²å½“æ—¥ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèª
5. ä¸¡æ–¹OKãªã‚‰ exit(0)ã€ã„ãšã‚Œã‹NGãªã‚‰ exit(1)
```

#### 8.2.4 å®Ÿè£…ä¾‹ï¼ˆéª¨æ ¼ï¼‰

```python
#!/usr/bin/env python3
"""
verify_grok_backup.py
S3ä¸Šã®Groké¸å®šçµæœã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ç¢ºèª

Exit codes:
  0: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ­£å¸¸ï¼ˆå®Ÿè¡Œå¯èƒ½ï¼‰
  1: ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¸å®Œå…¨ï¼ˆå®Ÿè¡Œä¸­æ–­ï¼‰
"""
import sys
import argparse
import os
from pathlib import Path
from io import BytesIO

ROOT = Path(__file__).resolve().parents[1]
sys.path.insert(0, str(ROOT))

import boto3
import pandas as pd
from botocore.exceptions import ClientError

def parse_args():
    parser = argparse.ArgumentParser(description="Verify Grok backup on S3")
    parser.add_argument("--bucket", type=str, help="S3 bucket name")
    parser.add_argument("--date", type=str, help="Target date (YYYYMMDD)")
    return parser.parse_args()

def main() -> int:
    args = parse_args()

    # S3ãƒã‚±ãƒƒãƒˆå
    bucket = args.bucket or os.getenv("S3_BUCKET", "stock-api-data")

    # å¯¾è±¡æ—¥ã‚’å–å¾—
    if args.date:
        target_date_yyyymmdd = args.date
    else:
        # grok_trending.parquet ã‹ã‚‰å–å¾—
        df = pd.read_parquet("data/parquet/grok_trending.parquet")
        if df.empty:
            print("[WARN] grok_trending.parquet is empty")
            return 0  # ç©ºãªã‚‰ã‚¹ã‚­ãƒƒãƒ—
        target_date = df['date'].iloc[0]
        target_date_yyyymmdd = target_date.replace('-', '')

    print(f"[INFO] Verifying backups for date: {target_date_yyyymmdd}")

    s3_client = boto3.client('s3')

    # 1. YYYYMMDD.parquet ã®ç¢ºèª
    key_daily = f"parquet/backtest/grok_trending_{target_date_yyyymmdd}.parquet"
    try:
        s3_client.head_object(Bucket=bucket, Key=key_daily)
        print(f"[OK] Daily backup exists: s3://{bucket}/{key_daily}")
    except ClientError as e:
        if e.response['Error']['Code'] == '404':
            print(f"[ERROR] Daily backup NOT found: s3://{bucket}/{key_daily}")
            return 1
        raise

    # 2. archive.parquet ã®ç¢ºèª
    key_archive = "parquet/backtest/grok_trending_archive.parquet"
    try:
        response = s3_client.get_object(Bucket=bucket, Key=key_archive)
        df_archive = pd.read_parquet(BytesIO(response['Body'].read()))

        target_date_formatted = f"{target_date_yyyymmdd[:4]}-{target_date_yyyymmdd[4:6]}-{target_date_yyyymmdd[6:]}"
        df_day = df_archive[df_archive['backtest_date'] == target_date_formatted]

        if len(df_day) > 0:
            print(f"[OK] Archive contains data for {target_date_formatted}: {len(df_day)} records")
            return 0
        else:
            print(f"[ERROR] Archive does NOT contain data for {target_date_formatted}")
            return 1

    except ClientError as e:
        if e.response['Error']['Code'] == '404':
            print(f"[ERROR] Archive NOT found: s3://{bucket}/{key_archive}")
            return 1
        raise

if __name__ == "__main__":
    raise SystemExit(main())
```

---

### 8.3 scripts/cleanup_grok_trending.py

#### 8.3.1 æ¦‚è¦

grok_trending.parquet ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å…¨å‰Šé™¤ã—ã€ã‚«ãƒ©ãƒ æ§‹é€ ã ã‘æ®‹ã™ã€‚

#### 8.3.2 å…¥å‡ºåŠ›ä»•æ§˜

**å…¥åŠ›:**
- grok_trending.parquetï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰

**å‡ºåŠ›:**
- Exit code 0: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æˆåŠŸ
- Exit code 1: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¤±æ•—
- æ¨™æº–å‡ºåŠ›: å‡¦ç†çµæœã®ãƒ­ã‚°

#### 8.3.3 å‡¦ç†ãƒ•ãƒ­ãƒ¼

```python
1. grok_trending.parquet ã‚’èª­ã¿è¾¼ã¿
2. ã‚«ãƒ©ãƒ æ§‹é€ ã‚’ä¿æŒã—ãŸã¾ã¾å…¨ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’å‰Šé™¤
3. ç©ºã®DataFrameã¨ã—ã¦ä¿å­˜
```

#### 8.3.4 å®Ÿè£…ä¾‹ï¼ˆéª¨æ ¼ï¼‰

```python
#!/usr/bin/env python3
"""
cleanup_grok_trending.py
grok_trending.parquet ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆéŠ˜æŸ„æƒ…å ±ã®ã¿å‰Šé™¤ï¼‰

Exit codes:
  0: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—æˆåŠŸ
  1: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¤±æ•—
"""
import sys
from pathlib import Path

ROOT = Path(__file__).resolve().parents[1]
sys.path.insert(0, str(ROOT))

import pandas as pd
from common_cfg.paths import PARQUET_DIR

GROK_TRENDING_PATH = PARQUET_DIR / "grok_trending.parquet"

def main() -> int:
    print("[INFO] Cleaning up grok_trending.parquet...")

    try:
        # èª­ã¿è¾¼ã¿
        df = pd.read_parquet(GROK_TRENDING_PATH)
        print(f"[INFO] Current records: {len(df)}")

        # ã‚«ãƒ©ãƒ æ§‹é€ ã ã‘æ®‹ã—ã¦ç©ºã«ã™ã‚‹
        df_empty = df.iloc[:0]

        # ä¿å­˜
        df_empty.to_parquet(GROK_TRENDING_PATH, index=False)
        print(f"[OK] Cleaned up: {GROK_TRENDING_PATH}")
        print(f"[OK] Records after cleanup: {len(df_empty)}")

        return 0

    except Exception as e:
        print(f"[ERROR] Failed to cleanup: {e}")
        return 1

if __name__ == "__main__":
    raise SystemExit(main())
```

---

### 8.4 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä¿®æ­£

#### 8.4.1 ç¿Œæ—¥å–¶æ¥­æ—¥ãƒã‚§ãƒƒã‚¯ã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ 

```yaml
- name: Check next day is trading day (23:00 only)
  id: check_next_trading
  if: steps.exec_mode.outputs.mode == 'grok_daily'
  env:
    JQUANTS_REFRESH_TOKEN: ${{ secrets.JQUANTS_REFRESH_TOKEN }}
  run: |
    echo "ğŸ” Checking if tomorrow is a trading day..."
    python3 scripts/check_next_day_trading.py
    EXIT_CODE=$?

    if [ $EXIT_CODE -eq 0 ]; then
      echo "âœ… Tomorrow is a trading day - will execute Grok selection"
    else
      echo "âŒ Tomorrow is NOT a trading day - skipping Grok selection"
    fi

    exit $EXIT_CODE
```

#### 8.4.2 S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ 

```yaml
- name: Verify S3 backups before Grok selection
  if: |
    success() &&
    steps.exec_mode.outputs.mode == 'grok_daily' &&
    steps.check_next_trading.conclusion == 'success'
  env:
    S3_BUCKET: ${{ env.S3_BUCKET }}
  run: |
    echo "ğŸ” Verifying S3 backups..."

    # grok_trending.parquet ã‹ã‚‰å¯¾è±¡æ—¥ã‚’å–å¾—
    TARGET_DATE=$(python3 -c "
    import pandas as pd
    df = pd.read_parquet('data/parquet/grok_trending.parquet')
    if not df.empty:
        print(df['date'].iloc[0].replace('-', ''))
    else:
        print('NO_DATA')
    ")

    if [ "$TARGET_DATE" = "NO_DATA" ]; then
      echo "âš ï¸ grok_trending.parquet is empty, skipping verification"
      exit 0
    fi

    echo "Target date: $TARGET_DATE"

    python3 scripts/verify_grok_backup.py --bucket "$S3_BUCKET" --date "$TARGET_DATE"
    EXIT_CODE=$?

    if [ $EXIT_CODE -eq 0 ]; then
      echo "âœ… S3 backups verified"
    else
      echo "âŒ S3 backup verification failed - aborting"
    fi

    exit $EXIT_CODE
```

#### 8.4.3 ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¹ãƒ†ãƒƒãƒ—è¿½åŠ 

```yaml
- name: Cleanup grok_trending.parquet
  if: |
    success() &&
    steps.exec_mode.outputs.mode == 'grok_daily' &&
    steps.check_next_trading.conclusion == 'success'
  run: |
    echo "ğŸ§¹ Cleaning up grok_trending.parquet..."
    python3 scripts/cleanup_grok_trending.py
```

#### 8.4.4 ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œæ¡ä»¶ä¿®æ­£

```yaml
- name: Run Data Pipeline
  id: pipeline
  if: |
    (steps.exec_mode.outputs.mode == 'stock_data') ||
    (steps.exec_mode.outputs.mode == 'grok_daily' && steps.check_next_trading.conclusion == 'success')
  env:
    ...
```

#### 8.4.5 ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆé‡è¤‡å®Ÿè¡Œã®ä¿®æ­£

```yaml
- name: Run backtest and archive
  if: success() && steps.exec_mode.outputs.skip_grok == 'true'  # â† 16æ™‚ã®ã¿ã«å¤‰æ›´
  run: |
    ...
```

---

## 9. ãƒ†ã‚¹ãƒˆè¦ä»¶

### 9.1 å˜ä½“ãƒ†ã‚¹ãƒˆ

| # | ãƒ†ã‚¹ãƒˆå¯¾è±¡ | ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ | æœŸå¾…çµæœ |
|---|-----------|-------------|---------|
| UT-001 | check_next_day_trading.py | ç¿Œæ—¥ãŒå–¶æ¥­æ—¥ | exit 0 |
| UT-002 | check_next_day_trading.py | ç¿Œæ—¥ãŒåœŸæ›œæ—¥ | exit 1 |
| UT-003 | check_next_day_trading.py | ç¿Œæ—¥ãŒç¥æ—¥ | exit 1 |
| UT-004 | check_next_day_trading.py | ç¿Œæ—¥ãŒ12æœˆ30æ—¥ | exit 1 (HolidayDivision=2) |
| UT-005 | verify_grok_backup.py | ä¸¡æ–¹ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å­˜åœ¨ | exit 0 |
| UT-006 | verify_grok_backup.py | YYYYMMDD.parquetä¸åœ¨ | exit 1 |
| UT-007 | verify_grok_backup.py | archive.parquetä¸åœ¨ | exit 1 |
| UT-008 | verify_grok_backup.py | archiveå†…ã«è©²å½“æ—¥ãƒ‡ãƒ¼ã‚¿ãªã— | exit 1 |
| UT-009 | cleanup_grok_trending.py | æ­£å¸¸ç³» | exit 0, ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°0 |

### 9.2 çµ±åˆãƒ†ã‚¹ãƒˆ

| # | ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª | å®Ÿè¡Œæ—¥æ™‚ | æœŸå¾…å‹•ä½œ |
|---|--------------|---------|---------|
| IT-001 | æœ¨æ›œ23æ™‚å®Ÿè¡Œ | ç¿Œæ—¥é‡‘æ›œã¯å–¶æ¥­æ—¥ | Groké¸å®šå®Ÿè¡Œ |
| IT-002 | é‡‘æ›œ23æ™‚å®Ÿè¡Œ | ç¿Œæ—¥åœŸæ›œã¯ä¼‘æ¥­æ—¥ | ã‚¹ã‚­ãƒƒãƒ— |
| IT-003 | æ—¥æ›œ23æ™‚å®Ÿè¡Œï¼ˆç¥å‰ï¼‰ | ç¿Œæ—¥æœˆæ›œã¯ç¥æ—¥ | ã‚¹ã‚­ãƒƒãƒ— |
| IT-004 | æ—¥æ›œ23æ™‚å®Ÿè¡Œï¼ˆé€šå¸¸ï¼‰ | ç¿Œæ—¥æœˆæ›œã¯å–¶æ¥­æ—¥ | Groké¸å®šå®Ÿè¡Œ |
| IT-005 | 16æ™‚ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å¤±æ•— | 23æ™‚ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª | å‡¦ç†ä¸­æ–­ï¼ˆexit 1ï¼‰ |
| IT-006 | ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¾Œé¸å®š | æ—§éŠ˜æŸ„ãŒæ®‹ã£ã¦ã„ãªã„ | æ–°éŠ˜æŸ„ã®ã¿ |

### 9.3 æœ¬ç•ªå‰ç¢ºèªãƒ†ã‚¹ãƒˆ

| # | ç¢ºèªé …ç›® | æ–¹æ³• |
|---|---------|------|
| PT-001 | 3æ—¥é–“ã®ç¶™ç¶šå®Ÿè¡Œ | æ‰‹å‹•ã§ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ |
| PT-002 | S3ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª | S3ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèª |
| PT-003 | ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ç¢ºèª | grok_trending_archive.parquet ã‚’åˆ†æ |
| PT-004 | ã‚³ã‚¹ãƒˆç¢ºèª | Grok APIä½¿ç”¨é‡ç¢ºèª |
| PT-005 | ãƒ­ã‚°ç¢ºèª | GitHub Actions ãƒ­ã‚°ã‚’ç¢ºèª |

---

## 10. ãƒ‡ãƒªãƒãƒªãƒ¼è¨ˆç”»

### 10.1 å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

| Phase | ä½œæ¥­å†…å®¹ | æœŸé–“ | æ‹…å½“ |
|-------|---------|------|------|
| **Phase 1** | ãƒ‡ãƒ¼ã‚¿æ¶ˆå¤±é˜²æ­¢ | 0.5æ—¥ | é–‹ç™ºè€… |
| | - verify_grok_backup.py ä½œæˆ | | |
| | - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«çµ„ã¿è¾¼ã¿ | | |
| | - å˜ä½“ãƒ†ã‚¹ãƒˆ | | |
| **Phase 2** | ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ä¿è¨¼ | 1æ—¥ | é–‹ç™ºè€… |
| | - check_next_day_trading.py ä½œæˆ | | |
| | - cleanup_grok_trending.py ä½œæˆ | | |
| | - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«çµ„ã¿è¾¼ã¿ | | |
| | - å˜ä½“ãƒ†ã‚¹ãƒˆ | | |
| **Phase 3** | x_searchç‰ˆå°å…¥ | 0.5æ—¥ | é–‹ç™ºè€… |
| | - generate_grok_trending.py æ›´æ–° | | |
| | - ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ | | |
| | - çµ±åˆãƒ†ã‚¹ãƒˆ | | |
| **Phase 4** | åŠ¹ç‡æ€§æ”¹å–„ | 0.5æ—¥ | é–‹ç™ºè€… |
| | - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¡ä»¶ä¿®æ­£ | | |
| | - çµ±åˆãƒ†ã‚¹ãƒˆ | | |
| **Phase 5** | æœ¬ç•ªå±•é–‹ | 1æ—¥ | é–‹ç™ºè€… |
| | - æœ¬ç•ªå‰ç¢ºèªãƒ†ã‚¹ãƒˆ | | |
| | - ãƒ‡ãƒ—ãƒ­ã‚¤ | | |
| | - ç›£è¦–ãƒ»æ¤œè¨¼ | | |

**ç·æœŸé–“:** 3.5æ—¥

### 10.2 ãƒ‡ãƒ—ãƒ­ã‚¤è¨ˆç”»

| # | ä½œæ¥­ | ã‚¿ã‚¤ãƒŸãƒ³ã‚° | å‚™è€ƒ |
|---|------|-----------|------|
| 1 | Phase 1-2 ãƒ‡ãƒ—ãƒ­ã‚¤ | å–¶æ¥­æ—¥ | ãƒ‡ãƒ¼ã‚¿ä¿è­·æ©Ÿèƒ½ã‚’å…ˆè¡Œå°å…¥ |
| 2 | 3æ—¥é–“ã®ç›£è¦– | - | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªãŒæ­£å¸¸å‹•ä½œã™ã‚‹ã‹ç¢ºèª |
| 3 | Phase 3-4 ãƒ‡ãƒ—ãƒ­ã‚¤ | å–¶æ¥­æ—¥ | x_searchç‰ˆã¨åŠ¹ç‡åŒ–ã‚’å°å…¥ |
| 4 | 1é€±é–“ã®ç›£è¦– | - | å…¨ä½“ã®å‹•ä½œã‚’ç¢ºèª |

### 10.3 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»

| Phase | ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ–¹æ³• | å½±éŸ¿ç¯„å›² |
|-------|---------------|---------|
| Phase 1-2 | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å‰ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æˆ»ã™ | ãƒ‡ãƒ¼ã‚¿ä¿è­·æ©Ÿèƒ½ãŒç„¡åŠ¹åŒ– |
| Phase 3 | ç’°å¢ƒå¤‰æ•°ã‚’ `PROMPT_VERSION=v1_0_baseline` ã«å¤‰æ›´ | x_searchãŒä½¿ç”¨ã•ã‚Œãªã„ |
| Phase 4 | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¡ä»¶ã‚’å…ƒã«æˆ»ã™ | é‡è¤‡å®Ÿè¡ŒãŒå¾©æ´» |

---

## 11. ãƒªã‚¹ã‚¯ã¨åˆ¶ç´„äº‹é …

### 11.1 ãƒªã‚¹ã‚¯ç®¡ç†

| # | ãƒªã‚¹ã‚¯ | å½±éŸ¿ | ç¢ºç‡ | å¯¾ç­– | å„ªå…ˆåº¦ |
|---|--------|------|------|------|-------|
| R-001 | J-Quants APIéšœå®³ | å–¶æ¥­æ—¥åˆ¤å®šä¸å¯ | ä½ | Fail-safeï¼ˆéå–¶æ¥­æ—¥ã¨åˆ¤å®šï¼‰ | ğŸŸ  é«˜ |
| R-002 | S3éšœå®³ | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªä¸å¯ | æ¥µä½ | AWSéšœå®³æ™‚ã¯å…¨ä½“åœæ­¢ | ğŸŸ¢ ä½ |
| R-003 | Grok APIéšœå®³ | éŠ˜æŸ„é¸å®šå¤±æ•— | ä½ | ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ç©ºãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ | ğŸŸ¡ ä¸­ |
| R-004 | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªèª¤æ¤œçŸ¥ | æ­£å¸¸ãªã®ã«ã‚¹ã‚­ãƒƒãƒ— | ä½ | è©³ç´°ãƒ­ã‚°ã§åŸå› ç‰¹å®š | ğŸŸ¡ ä¸­ |
| R-005 | ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å¤±æ•— | æ—§éŠ˜æŸ„æ®‹å­˜ | ä½ | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒå¯èƒ½ | ğŸŸ¢ ä½ |
| R-006 | ã‚³ã‚¹ãƒˆè¶…é | äºˆç®—ã‚ªãƒ¼ãƒãƒ¼ | ä½ | æœˆæ¬¡ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚° | ğŸŸ¢ ä½ |

### 11.2 åˆ¶ç´„äº‹é …

| # | åˆ¶ç´„ | èª¬æ˜ |
|---|------|------|
| C-001 | GitHub Actionså®Ÿè¡Œæ™‚é–“ | æœ€å¤§6æ™‚é–“ï¼ˆé€šå¸¸15åˆ†ä»¥å†…ï¼‰ |
| C-002 | S3ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ | ç„¡åˆ¶é™ï¼ˆãŸã ã—ã‚³ã‚¹ãƒˆè€ƒæ…®ï¼‰ |
| C-003 | Grok APIåˆ¶é™ | Rate limit: æœªç¢ºèªï¼ˆé€šå¸¸å•é¡Œãªã—ï¼‰ |
| C-004 | J-Quants APIåˆ¶é™ | Free plan: 500 requests/dayï¼ˆååˆ†ï¼‰ |
| C-005 | ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿æŒæœŸé–“ | 7æ—¥é–“ï¼ˆãã‚Œä»¥å‰ã¯å‰Šé™¤ï¼‰ |
| C-006 | archive.parquet | ä¸Šæ›¸ãå³ç¦ã€è¿½åŠ ã®ã¿ |

### 11.3 å‰ææ¡ä»¶

| # | å‰æ | ç¢ºèªæ–¹æ³• |
|---|------|---------|
| P-001 | S3ãƒã‚±ãƒƒãƒˆãŒå­˜åœ¨ | AWS Consoleç¢ºèª |
| P-002 | GitHub SecretsãŒè¨­å®šæ¸ˆã¿ | XAI_API_KEY, JQUANTS_REFRESH_TOKEN |
| P-003 | IAMãƒ­ãƒ¼ãƒ«ãŒæ­£ã—ãè¨­å®š | S3ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ç¢ºèª |
| P-004 | manifest.json ãŒæ­£å¸¸ã«æ›´æ–°ã•ã‚Œã‚‹ | ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œå¾Œç¢ºèª |
| P-005 | ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã«AWS CLIã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ | `aws --version` |

---

## 12. æ‰¿èª

### 12.1 è¦ä»¶å®šç¾©æ›¸ã®æ‰¿èª

| å½¹å‰² | æ°å | æ‰¿èªæ—¥ | ç½²å |
|------|------|-------|------|
| é–‹ç™ºè€… | - | 2025-11-03 | - |
| ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ | - | - | - |

### 12.2 å¤‰æ›´å±¥æ­´

| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | æ—¥ä»˜ | å¤‰æ›´å†…å®¹ | å¤‰æ›´è€… |
|-----------|------|---------|-------|
| 1.0 | 2025-11-03 | åˆç‰ˆä½œæˆ | Claude |

---

## ä»˜éŒ²

### A. ç”¨èªé›†

| ç”¨èª | èª¬æ˜ |
|------|------|
| **Grok** | xAIç¤¾ãŒæä¾›ã™ã‚‹å¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ« |
| **x_search** | Xï¼ˆTwitterï¼‰æŠ•ç¨¿ã‚’æ¤œç´¢ã™ã‚‹ãƒ„ãƒ¼ãƒ«ï¼ˆ$25/1,000 sourcesï¼‰ |
| **web_search** | ä¸€èˆ¬çš„ãªWebæ¤œç´¢ãƒ„ãƒ¼ãƒ« |
| **J-Quants** | æ—¥æœ¬å–å¼•æ‰€ã‚°ãƒ«ãƒ¼ãƒ—ãŒæä¾›ã™ã‚‹æ ªå¼ãƒ‡ãƒ¼ã‚¿API |
| **HolidayDivision** | J-Quantsã®å–¶æ¥­æ—¥åŒºåˆ†ï¼ˆ1:å–¶æ¥­æ—¥, 0:ä¼‘æ¥­æ—¥, 2:ç‰¹åˆ¥ä¼‘æ¥­æ—¥ï¼‰ |
| **Phase1** | å¯„ä»˜ï½å‰å ´çµ‚äº†ã®ãƒ‡ã‚¤ãƒˆãƒ¬æˆ¦ç•¥ |
| **Phase2** | å¯„ä»˜ï½å¤§å¼•ã‘ã®ãƒ‡ã‚¤ãƒˆãƒ¬æˆ¦ç•¥ |
| **Phase3** | åˆ©ç¢ºãƒ»æåˆ‡ã‚Šè¨­å®šä»˜ããƒ‡ã‚¤ãƒˆãƒ¬æˆ¦ç•¥ |
| **backtest_date** | ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆå®Ÿæ–½æ—¥ï¼ˆå–å¼•æ—¥ï¼‰ |
| **selection_date** | GrokéŠ˜æŸ„é¸å®šæ—¥ï¼ˆå‰å–¶æ¥­æ—¥23æ™‚ï¼‰ |
| **manifest.json** | S3ä¸Šã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ« |

### B. å‚è€ƒè³‡æ–™

- **xAI Grok API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://docs.x.ai/
- **J-Quants API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://jpx.gitbook.io/j-quants-ja
- **GitHub Actions ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://docs.github.com/actions
- **AWS S3 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: https://docs.aws.amazon.com/s3/

### C. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- `workflow_execution_flow.md` - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œãƒ•ãƒ­ãƒ¼å›³
- `workflow_verification_report.md` - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ
- `design_philosophy_evaluation.md` - è¨­è¨ˆæ€æƒ³ã®è©•ä¾¡
- `s3_architecture_correction.md` - S3ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æ­£ã—ã„ç†è§£

---

**ä»¥ä¸Š**
